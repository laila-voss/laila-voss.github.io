webpackJsonp([1],{309:function(e,t,i){var n,s;n=[i(0),i(287),i(773),i(775)],void 0!==(s=function(e,t,i,n){"use strict";return e.Class.declare({$name:"TimingRendererBundle",$extends:t,getDefinedRenderers:function(){return{Timing:i}},getDefinedTemplates:function(){return{Timing:n}}})}.apply(t,n))&&(e.exports=s)},310:function(e,t,i){var n,s;n=[i(22),i(0),i(287),i(776),i(787)],void 0!==(s=function(e,t,i,n,s){"use strict";return t.Class.declare({$name:"TreeSelectRendererBundle",$extends:i,getDefinedRenderers:function(){return{TreeSelect:n}},getDefinedTemplates:function(){return{TreeSelect:s}}})}.apply(t,n))&&(e.exports=s)},372:function(e,t,i){var n,s;n=[i(3),i(99),i(0)],void 0!==(s=function(e,t,i){"use strict";return i.AbstractClass.declare({$name:"HiddenQuestionRendererHTML",$extends:t,showHiddenQuestion:function(e){this.runtime.SeparatorDisplayed=e,this.runtime.NotRendered=!e}})}.apply(t,n))&&(e.exports=s)},773:function(e,t,i){var n,s;n=[i(3),i(372),i(774),i(22),i(2),i(28),i(0)],void 0!==(s=function(e,t,i,n,s,r,a){"use strict";return a.Class.declare({$name:"TimingRendererHTML",$extends:t,isMobilePreview:!1,__secondsUntilNextButtonEnabled:0,__secondsUntilAutoAdvance:0,__showTimer:!1,__countDirection:null,__countSeconds:0,__lastTouchEvent:0,timer:null,choicesToRuntimeMapping:{1:"FirstClick",2:"LastClick",3:"TotalTime",4:"NumClicks"},initialize:function(e){this.$super(e),this.__secondsUntilNextButtonEnabled=e.Configuration.MinSeconds||0,this.__secondsUntilAutoAdvance=e.Configuration.MaxSeconds||0,this.__showTimer=e.Configuration.ShowTimer,this.__countSeconds=e.Configuration.Seconds||0,this.__countDirection=e.Configuration.CountDirection,this.runtime.FirstTimeDisplayed?(this.__resetClicks(),this.runtime.FirstTimeDisplayed=!1):this.__initClicks(),this.__showTimer&&(0===this.__countSeconds&&"Incrementing"===this.__countDirection&&(this.__countSeconds=86400),this.__setupTimerDisplay()),this.timer=new i,this.on("postrender",this._postrender.$bind(this)),this.on("bind",this.__addClickWatcher.$bind(this)),this.on("unbind",this.__removeClickWatcher.$bind(this)),this.on("unbind",function(){this.timer.end()}.$bind(this))},_postrender:function(){this.__timingDisabled()||(this.isMobilePreview=this.getPage().isMobilePreviewFrame(),this.__showTimer&&this.__setupTimerDisplay(),this.addAdvancePageFunction(function(){this.timer.end()}.$bind(this)),this.__setupEvents(),this.isMobilePreview?this.__watchCurrentTime():this.__setupPopulateFinalCount(),this.getPage().pageButtons.disableButtons(!0),this.getPage().once("ready",this._ready.$bind(this)),this.getPage().once("ready:imagesLoaded",this._readyImagesLoaded.$bind(this)))},_ready:function(){this.__hideNavigationButtonsIfNeeded()},_readyImagesLoaded:function(){this.timer.start(),this.__hideNavigationButtonsIfNeeded(),this.getPage().pageButtons.enableButtons(!0,!1)},__initClicks:function(){this.runtime.FirstClick=parseFloat(this.runtime.FirstClick)||0,this.runtime.LastClick=parseFloat(this.runtime.LastClick)||0,this.runtime.TotalTime=parseFloat(this.runtime.TotalTime)||0,this.runtime.NumClicks=parseFloat(this.runtime.NumClicks)||0},__resetClicks:function(){this.runtime.FirstClick=0,this.runtime.LastClick=0,this.runtime.TotalTime=0,this.runtime.NumClicks=0},__setupEvents:function(){this.__secondsUntilAutoAdvance>0&&!this.isMobilePreview&&!this.getPage().failedValidationPage()&&this.timer.after(this.__secondsUntilAutoAdvance,this._autoAdvancePage,this),this.__secondsUntilNextButtonEnabled>0&&this.timer.after(this.__secondsUntilNextButtonEnabled,this._enableNextButton,this),this.__showTimer&&!this.isMobilePreview&&("Incrementing"===this.__countDirection?(this.runtime.DestinationTime=this.__countSeconds,this.runtime.CurrentTime=0):(this.runtime.CurrentTime=this.__countSeconds,this.runtime.DestinationTime=0),this.timer.on("tick",this._updateDisplayedClock))},__setupTimerDisplay:function(){this.isMobilePreview||(this.runtime.FlipClock={h1:0,h2:0,m1:0,m2:0,s1:0,s2:0},"Incrementing"!=this.__countDirection&&(this.runtime.FlipClock.h1=Math.floor(this.__countSeconds/3600/10),this.runtime.FlipClock.h2=Math.floor(this.__countSeconds/3600)%10,this.runtime.FlipClock.m1=Math.floor(this.__countSeconds%3600/60/10),this.runtime.FlipClock.m2=Math.floor(this.__countSeconds%3600/60)%10,this.runtime.FlipClock.s1=Math.floor(this.__countSeconds%3600%60/10),this.runtime.FlipClock.s2=this.__countSeconds%3600%60%10),this.runtime.FlipClock.showHours=this.__countSeconds/3600>=1,this.runtime.FlipClock.showMinutes=this.__countSeconds/60>=1)}.$bound(),__timingDisabled:function(){return this.getPage().isPageSummary()},__hideNavigationButtonsIfNeeded:function(){if(this.__secondsUntilNextButtonEnabled>0&&!this.__timingDisabled())return this.getPage().pageButtons.hideNextButton(),!0},__setupPopulateFinalCount:function(){this.addAdvancePageFunction(this.__populateFinalCounts)},_getTotalTimeOnPage:function(){return this.timer.getElapsedTime()+this.runtime.TotalTime},__addClickWatcher:function(){this.__timingDisabled()||n(window).on("mouseup touchend",this.__onMouseUp)},__removeClickWatcher:function(){this.__timingDisabled()||n(window).off("mouseup touchend",this.__onMouseUp)},_autoAdvancePage:function(){this.getPage().pageButtons.busifyNavigationButtons(),this.getPage().next({requestResponseOverride:!0,timingAutoAdvance:!0})}.$bound(),_enableNextButton:function(){this.getPage().pageButtons.showNextButton()}.$bound(),_updateDisplayedClock:function(e){e=Math.floor(e);var t;t="Incrementing"===this.__countDirection?Math.min(e,this.__countSeconds):Math.max(this.__countSeconds-e,0);var i=this.getTimeArray(this.runtime.CurrentTime);this.runtime.CurrentTime=t,t=this.getTimeArray(t),this.changeTime(i,t),this.__isTimerFinished()&&this.timer.off("tick",this._updateDisplayedClock)}.$bound(),__onMouseUp:function(e){if("NextButton"!==e.target.id&&this.timer.isRunning()){var t=this._getTotalTimeOnPage();if(s.isNaN(t))return;if("mouseup"===e.type&&+new Date-this.__lastTouchEvent<100)return;this.runtime.FirstClick||(this.runtime.FirstClick=t),this.runtime.LastClick=t,this.runtime.NumClicks+=1,"touchend"===e.type&&(this.__lastTouchEvent=+new Date)}}.$bound(),__populateFinalCounts:function(){this.runtime.TotalTime=this._getTotalTimeOnPage()}.$bound(),__watchCurrentTime:function(){r.watch(this.runtime,"CurrentTime",function(e,t,i,n){n&&this.changeTime(this.getTimeArray(n),this.getTimeArray(i))}.$bind(this))},__isTimerFinished:function(){return Math.abs(this.runtime.DestinationTime-this.runtime.CurrentTime)<=0},getCurrentTime:function(){return"number"==typeof this.runtime.CurrentTime?Math.round(this.runtime.CurrentTime):this.runtime.CurrentTime},changeTime:function(e,t){this.__flipNumber(e.s,t.s,"S"),this.__flipNumber(e.m,t.m,"M"),this.__flipNumber(e.h,t.h,"H")},populateStartAndEndTimes:function(){this.runtime.CurrentTime>=0||("Incrementing"===this.__countDirection?(this.runtime.DestinationTime=this.__countSeconds,this.runtime.CurrentTime=0):(this.runtime.CurrentTime=this.__countSeconds,this.runtime.DestinationTime=0))}.$bound(),__doFlip:function(e,t,i){this.runtime.FlipClock[i.toLowerCase()]=t;var n=this.generateFieldSet(e,t),s=this._$el.find("#"+this.id()+i);s.append(n),setTimeout(function(){n.addClass("Flip")},50),setTimeout(function(){s.length>0&&(s.children(".Number").html(t),s.find(".Flip").remove())},800)},__flipNumber:function(e,t,i){e!==t&&(e%10!=t%10&&this.__doFlip(e%10,t%10,i+"2"),e=Math.max(Math.floor(e/10),0),t=Math.max(Math.floor(t/10),0),e!=t&&this.__doFlip(e,t,i+"1"))}.$bound(),generateFieldSet:function(e,t){return n('<fieldset><span class="Change B">'+t+'</span><span class="Change TF">'+e+'</span><span class="Change TB">'+t+"</span></fieldset>")},getTimeArray:function(e){return e=Number(e),{h:Math.floor(e/3600),m:Math.floor(e%3600/60),s:Math.round(e%3600%60)}},hasResponse:function(){return this.displayed()},render:function(e){return this.runtime.NotRendered=!this.getPage().shouldShowHiddenQuestions(),this.$super(e)},addAdvancePageFunction:function(t){try{this.getPage().once("beforeSerialize",t)}catch(t){e.error("Failed to add advance page function for timing question",t)}}})}.apply(t,n))&&(e.exports=s)},774:function(e,t,i){var n,s;n=[i(3),i(4),i(0),i(2),i(26)],void 0!==(s=function(e,t,i,n,s){"use strict";return i.Class.declare({$name:"TimingEvents",$extends:s,_runningTimer:null,_lastCheck:null,_startTime:null,_accumulatedTime:0,_tickInterval:100,__afterEvents:[],initialize:function(e){e>0&&(this._tickInterval=+e)},start:function(){null===this._runningTimer&&(this._startTime=Date.now(),this._lastCheck=this._startTime,this._accumulatedTime=0,this.on("tick",this.__checkAfterEvents),this.__startClock())},end:function(){this.off("tick",this.__checkAfterEvents),clearTimeout(this._runningTimer),this._runningTimer=null},after:function(e,t){for(var i={time:e,callback:t},n=0;n<this.__afterEvents.length;n++)if(e>this.__afterEvents[n].time)return void this.__afterEvents.splice(n,0,i);this.__afterEvents.push(i)},getElapsedTime:function(){var e=Date.now(),t=e-this._lastCheck,i=this._lastCheck-this._startTime;return(t<0||t>this._tickInterval)&&(t=0),(i+this._accumulatedTime+t)/1e3},isRunning:function(){return null!==this._runningTimer},__checkAfterEvents:function(e){for(var t=this.__afterEvents.length-1;t>=0;t--){if(!(e>=this.__afterEvents[t].time))return;this.__afterEvents[t].callback(e),this.__afterEvents.splice(t,1)}},__startClock:function(){var e=Date.now()+this._tickInterval,t=function(){var i=Date.now(),n=i-e,s=Math.max(0,this._tickInterval-n);(i<e-this._tickInterval||n>61e3)&&(this._accumulatedTime+=this._lastCheck-this._startTime+this._tickInterval,this._startTime=i,s=100),this._trigger("tick",this.getElapsedTime()),e=i+s,this._lastCheck=i,this._runningTimer=setTimeout(t,s)}.$bind(this);this._runningTimer=setTimeout(t,this._tickInterval)}})}.apply(t,n))&&(e.exports=s)},775:function(e,t){e.exports='<div  data-runtime-hide="runtime.NotRendered">\n<div class=\'QuestionText\' >{{=Q.runtime.QuestionText}}</div>\n<div class=\'QuestionBody UnhiddenQuestion\'>\n<em data-runtime-text="runtime.WontBeDisplayedText"></em>\n<ul class=\'ChoiceStructure\'>\n  <table role="presentation">\n    <tbody>\n      {{ for (var choiceId in Q.runtime.Choices) { }}\n        <tr>\n          <th data-runtime-html="runtime.Choices.{{=choiceId}}.Display"></th>\n          <td>\n            <span id=\'QR~{{=Q.id()}}~{{=choiceId}}~Display\' data-runtime-text="runtime.{{=Q.choicesToRuntimeMapping[choiceId]}}"></span>\n            {{ /* FIXME: there are not translations for these phrases (we do the same lame thing SE does here) */ }}\n            {{=Q.choicesToRuntimeMapping[choiceId].indexOf(\'Clicks\') === -1 ? \'seconds\' : \'clicks\'}}\n          </td>\n        </tr>\n      {{ } }}\n    </tbody>\n  </table>\n</ul>\n</div>\n</div>\n\n{{ if(Q.runtime.Configuration.ShowTimer == true) { }}\n\x3c!-- The -webkit-backface-visibility setting is to prevent flickering when in an iframe in chrome --\x3e\n<div id="{{=Q.runtime.ID}}Timer" class="Timer FlipClock" style=\'-webkit-backface-visibility: hidden;\'>\n    {{ if (Q.runtime.FlipClock.showHours == true) { }}\n    <span id="{{=Q.runtime.ID}}H1" class="H T1">\n        <span class="Number">{{=Q.runtime.FlipClock.h1}}</span>\n        <b></b>\n    </span>\n    <span id="{{=Q.runtime.ID}}H2" class="H T2">\n        <span class="Number">{{=Q.runtime.FlipClock.h2}}</span>\n        <b></b>\n    </span>\n    {{ } }}\n    {{ if (Q.runtime.FlipClock.showMinutes == true) { }}\n    <span id="{{=Q.runtime.ID}}M1" class="M T1">\n        <span class="Number">{{=Q.runtime.FlipClock.m1}}</span>\n        <b></b>\n    </span>\n    <span id="{{=Q.runtime.ID}}M2" class="M T2">\n        <span class="Number">{{=Q.runtime.FlipClock.m2}}</span>\n        <b></b>\n    </span>\n    {{ } }}\n    <span id="{{=Q.runtime.ID}}S1" class="S T1">\n        <span class="Number">{{=Q.runtime.FlipClock.s1}}</span>\n        <b></b>\n    </span>\n    <span id="{{=Q.runtime.ID}}S2" class="S T2">\n        <span class="Number">{{=Q.runtime.FlipClock.s2}}</span>\n        <b></b>\n    </span>\n</div>\n{{ } }}\n'},776:function(e,t,i){var n,s;n=[i(99),i(777),i(779),i(783),i(2),i(28),i(0),i(3),i(1)],void 0!==(s=function(e,t,i,n,s,r,a,h,c){"use strict";return a.Class.declare({$name:"TreeSelectRendererHTML",$extends:e,leavingPage:!1,selectedUnitId:null,compactView:null,searchView:null,initialize:function(e){this.$super(e),this.runtime.newUnitsED=this.runtime.newUnitsED||[],this.runtime.originalUnitsED=this.runtime.originalUnitsED||{},this.runtime.responseObject=this.runtime.responseObject||{},this.on("prerender",this._prerender,this),this.on("postrender",this._postRender,this),this.on("beforeNext",function(){this.leavingPage=!0}.$bind(this))},_prerender:function(){var e=this._page.getPageTemplate();for(var i in this.runtime.TreeSelectMessages)e.setMessage(i,this.runtime.TreeSelectMessages[i]);this.selectText=new t(this.getMessageFromTemplate("HierarchySelectedText"))},_postRender:function(){this.leavingPage=!1,"SearchOnly"==this.runtime.DisplayType?(this._renderSearch(),this._setupWatchForResponse()):"HierarchyAndSearch"==this.runtime.DisplayType?(this._renderSearch(),this._renderCompactView()):this._renderCompactView()},_renderSearch:function(){this.searchView=new n(this),this._$el.find(".OHOuter").append(this.searchView.render()),this.searchView.setupSearch(),this.hasResponse()&&(this.OrgHierarchy&&this.OrgHierarchy.units[this.runtime.responseObject.unitId]?this.renderSelectedText(this.OrgHierarchy.units[this.runtime.responseObject.unitId].name):this._getParentUnits(this.runtime.responseObject.unitId).then(function(){this.renderSelectedText(this.OrgHierarchy.units[this.runtime.responseObject.unitId].name)}.$bind(this)))},_renderCompactView:function(){if(this.compactView=new i(this),this._$el.find(".OHOuter").append(this.compactView.render()),this.hasResponse())this.getAndRenderCompactView();else if(this.__getAutoSelectUnit()){var e=this.__getAutoSelectUnit();this.compactView.getOrgHierarchy().then(function(){return this._getParentUnits(e)}.$bind(this)).then(function(t){s.isEmpty(t)?(this.selectedUnitId=this.OrgHierarchy.rootUnitID,this.compactView.setup()):this.compactView.renderFullUnitChain(e,t)}.$bind(this))}else this.compactView.getOrgHierarchy().then(function(){this.selectedUnitId=this.OrgHierarchy.rootUnitID,this.compactView.setup()}.$bind(this))},__getAutoSelectUnit:function(){var e="AutoSelect"+this.runtime.OrgHierarchyId;return this._page.getED(e)},hasResponse:function(){return!!s.get(this.runtime.responseObject,"unitId")&&!!s.get(this.runtime.responseObject,"unitChain")},getResponse:function(){return this.hasResponse()?this.runtime.responseObject:{}},_setupWatchForResponse:function(){r.watch(this.runtime,"responseObject",function(){if(s.get(this.runtime.responseObject,"unitId")!==this.selectedUnitId)if(this.selectedUnitId=this.runtime.responseObject.unitId,"CompactView"==this.runtime.DisplayType)this.compactView.toggleUnit(s.get(this.runtime.responseObject,"unitId"));else if("HierarchyAndSearch"==this.runtime.DisplayType)this.getAndRenderCompactView();else if("SearchOnly"==this.runtime.DisplayType)return this.setResponseForSearch(this.runtime.responseObject.unitId).then(function(){s.get(this.OrgHierarchy.units[this.runtime.responseObject.unitId],"name")?(this.renderSelectedText(this.OrgHierarchy.units[this.runtime.responseObject.unitId].name),this.selectedUnitId=this.runtime.responseObject.unitId):h.error('expected parameter "name" not set for selected unit')}.$bind(this))}.$bind(this))},getAndRenderCompactView:function(){this.compactView.getUnitChainUnits(this.runtime.responseObject.unitId,this.runtime.responseObject.unitChain).then(function(){this.selectedUnitId=this.runtime.responseObject.unitId,this.compactView.renderFullUnitChain(this.runtime.responseObject.unitId,this.runtime.responseObject.unitChain)}.$bind(this))},renderSelectedText:function(e){this.selectText.setUnitName(e),this._$el.find(".SelctedTextContainer").empty().append(this.selectText.render())},setResponse:function(e){this.clearPreviousResponseED();var t=this._getParentIDs(e),i=this.OrgHierarchy.units[e].unitMetadata;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&this._updateEDList(n,[i[n]]);this._updateEDList("Q_PrimaryUnits",[e]),this._updateEDList("Q_PrimaryUnits_"+this.OrgHierarchy.id,[e]),this._updateEDList("Q_Units",[e].concat(t)),this._updateEDList("Q_Units_"+this.OrgHierarchy.id,[e].concat(t)),this.runtime.responseObject={unitId:e,unitChain:t,newUnitsED:this.runtime.newUnitsED},this.runtime.NodeChain=t},clearPreviousResponseED:function(){s.each(this.runtime.newUnitsED,function(e){this._page.nullifyEDField(e)}.$bind(this)),this.runtime.newUnitsED=[]},_updateEDList:function(e,t){if(this._page.getED(e)){var i=t,n=[];s.each(i,function(e){-1===c.inArray(e,n)&&n.push(e)}),this._page.setED(e,n)}else this.runtime.newUnitsED.push(e),this._page.setED(e,t)},_getParentIDs:function(e){for(var t=e,i=[];this.OrgHierarchy.units[t].parentID;)i.unshift(this.OrgHierarchy.units[t].parentID),t=this.OrgHierarchy.units[t].parentID;return i},setResponseForSearch:function(e){return this._getParentUnits(e).then(function(){this.setResponse(e)}.$bind(this))},_getParentUnits:function(e){return this._page.adapter.getUnits(this.runtime.baseURL||this.runtime.BaseServiceURL,this.runtime.BrandId,e,!1,!0).then(function(t){var i=[];return t.reverse(),s.each(t,function(t){this.OrgHierarchy.units[t.id]=t;var n=t.parentID;this.OrgHierarchy.units[t.id].depth=n&&this.OrgHierarchy.units[n]?this.OrgHierarchy.units[n].depth+1:0,t.id!==e&&i.push(t.id)}.$bind(this)),i}.$bind(this))}})}.apply(t,n))&&(e.exports=s)},777:function(e,t,i){var n,s;n=[i(778),i(0),i(5)],void 0!==(s=function(e,t,i){"use strict";return t.Class.declare({$name:"SelectedTextHTML",selectedUnitName:null,selectMessage:null,initialize:function(e){this.selectMessage=e},setUnitName:function(e){this.selectedUnitName=e},render:function(){return i.template(e)({name:this.selectedUnitName,selectMessage:this.selectMessage})}})}.apply(t,n))&&(e.exports=s)},778:function(e,t){e.exports='<div class="SelectedText">{{=it.selectMessage}} <b>{{=it.name}}</b></div>\n'},779:function(e,t,i){var n,s;n=[i(780),i(782),i(2),i(0),i(3),i(1),i(4),i(5)],void 0!==(s=function(e,t,i,n,s,r,a,h){"use strict";return n.Class.declare({$name:"TreeSelectCompactViewHTML",treeSelect:null,initialize:function(e){this.treeSelect=e},render:function(){return h.template(t)},setup:function(){if(this.treeSelect.selectedUnitId=this.treeSelect.OrgHierarchy.rootUnitID,this.renderRootNode(),this.renderChildNodes(this.treeSelect.OrgHierarchy.rootUnitID),1==this.treeSelect.OrgHierarchy.units[this.treeSelect.OrgHierarchy.rootUnitID].childIDs.length){var e=this.treeSelect.OrgHierarchy.units[this.treeSelect.OrgHierarchy.rootUnitID].childIDs[0];i.get(this.treeSelect.OrgHierarchy.units,e)&&this.toggleUnit(e)}this.treeSelect._setupWatchForResponse()},getOrgHierarchy:function(){return i.get(this.treeSelect.OrgHierarchy,"units")&&0!==Object.keys(this.treeSelect.OrgHierarchy.units).length?a.resolve():this.treeSelect._page.adapter.getOrgHierarchy(this.treeSelect.runtime.baseURL||this.treeSelect.runtime.BaseServiceURL,this.treeSelect.runtime.BrandId,this.treeSelect.runtime.OrgHierarchyId).then(function(e){this.treeSelect.OrgHierarchy=e,this._initialNodeDepth()}.$bind(this))},_initialNodeDepth:function(){i.each(this.treeSelect.OrgHierarchy.units,function(e){var t=e.id===this.treeSelect.OrgHierarchy.rootUnitID?0:1;this.treeSelect.OrgHierarchy.units[e.id].depth=t}.$bind(this))},renderRootNode:function(){var e=this.treeSelect._$el.find(".MobileUnits");e.empty(),this._addNode(e,this.treeSelect.OrgHierarchy.rootUnitID,0)},_addNode:function(t,i){var n=this.treeSelect.selectedUnitId===i,s=this.treeSelect.OrgHierarchy.units[i].depth,r=new e(this.treeSelect.OrgHierarchy,i,n,s);t.append(r.render())},getUnitChainUnits:function(e,t){return this.getOrgHierarchy().then(function(){var i=t.concat([e]);return a.map(i,function(e){return this._areChildUnitsLoaded(e)?a.resolve():this._getChildrenUnits(e,i.indexOf(e)+1)}.$bind(this),{concurrency:3})}.$bind(this))},renderFullUnitChain:function(e,t){this.renderRootNode(),i.each(t.concat([e]),function(e){if(e!==this.treeSelect.OrgHierarchy.rootUnitID){var t=this._getUnitElement(this.treeSelect.OrgHierarchy.units[e].parentID).find(".Children");this._addNode(t,e)}}.$bind(this)),this.toggleUnit(e),this.treeSelect._setupWatchForResponse()},renderChildNodes:function(e){if(!this.treeSelect.leavingPage){var t=this._getUnitElement(e).find(".Children");t.empty();var n=i.map(this.treeSelect.OrgHierarchy.units[e].childIDs,function(e){return this.treeSelect.OrgHierarchy.units[e]}.$bind(this));n.sort(function(e,t){return e.name.localeCompare(t.name)}),i.each(n,function(e){i.get(e,"id")&&this._addNode(t,e.id)}.$bind(this)),this._setupToggles(!0),this._preLoadUnits(e)}},_setupToggles:function(e){var t=this.treeSelect._$el.find(".Toggle");e&&t.unbind(),t.click(this._toggle.$bind(this))},_toggle:function(e){var t=r(e.target).closest(".Unit"),i=t.attr("id");this.toggleUnit(i)},toggleUnit:function(e){this._removeChildrenForToggle(this.treeSelect.selectedUnitId,e),this._getUnitElement(this.treeSelect.selectedUnitId).removeClass("Selected"),this._getUnitElement(e).addClass("Selected"),this.treeSelect.renderSelectedText(this.treeSelect.OrgHierarchy.units[e].name),this.treeSelect.selectedUnitId=e,this.treeSelect.setResponse(e),this._areChildUnitsLoaded(e)?this.renderChildNodes(e):this._getUnitsAndRender(e)},_removeChildrenForToggle:function(e,t){e&&i.each(this.treeSelect.OrgHierarchy.units[e].childIDs,function(e){e!==t&&this._getUnitElement(e).remove()}.$bind(this))},_getUnitElement:function(e){return this.treeSelect._$el.find("#"+e)},_areChildUnitsLoaded:function(e){if(!this.treeSelect.OrgHierarchy.units[e])return!1;for(var t=0;t<this.treeSelect.OrgHierarchy.units[e].childIDs.length;t++){var i=this.treeSelect.OrgHierarchy.units[e].childIDs[t];if(!Object.prototype.hasOwnProperty.call(this.treeSelect.OrgHierarchy.units,i))return!1}return!0},_getUnitsAndRender:function(e){var t=setTimeout(function(){this._getUnitElement(e).find(".smallBarLoadingImage").show()}.$bind(this),400);this._getChildrenUnits(e).then(function(){clearTimeout(t),this.renderChildNodes(e)}.$bind(this))},_getChildrenUnits:function(e,t){return this.treeSelect.leavingPage||this._areChildUnitsLoaded(e)?a.resolve():this.treeSelect._page.adapter.getUnits(this.treeSelect.runtime.baseURL||this.treeSelect.runtime.BaseServiceURL,this.treeSelect.runtime.BrandId,e,!0,!1).then(function(e){if(!this.treeSelect.leavingPage)for(var i in e){this.treeSelect.OrgHierarchy.units[i]=e[i];var n=e[i].parentID;this.treeSelect.OrgHierarchy.units[i].depth=t||this.treeSelect.OrgHierarchy.units[n].depth+1}}.$bind(this))},_preLoadUnits:function(e){return a.map(this.treeSelect.OrgHierarchy.units[e].childIDs,function(e){if(!this.treeSelect.leavingPage&&-1!==this.treeSelect.OrgHierarchy.units[this.treeSelect.selectedUnitId].childIDs.indexOf(e))return this._areChildUnitsLoaded(e)?void 0:this._getChildrenUnits(e)}.$bind(this),{concurrency:3})}})}.apply(t,n))&&(e.exports=s)},780:function(e,t,i){var n,s;n=[i(781),i(0),i(5)],void 0!==(s=function(e,t,i){"use strict";return t.Class.declare({$name:"TreeSelectNodeHTML",orgHierarchy:null,unitId:null,selected:null,depth:null,initialize:function(e,t,i,n){this.orgHierarchy=e,this.unitId=t,this.selected=i,this.depth=n},render:function(){return i.template(e)({orgHierarchy:this.orgHierarchy,unitId:this.unitId,selected:this.selected,depth:this.depth})}})}.apply(t,n))&&(e.exports=s)},781:function(e,t){e.exports='<li class="Unit{{?it.selected}} Selected{{?}}" id="{{=it.unitId}}">\n  <div class="Hover">\n    <div class="UnitContainer">\n      <div class="UnitLabelContainer Hover" style="{{?it.depth > 0}}left: {{=it.depth * 5}}px{{?}}">\n        <label class="{{=it.orgHierarchy.units[it.unitId].id}} Toggle">\n          <span class="Text">\n          {{= it.orgHierarchy.units[it.unitId].name}}\n          </span>\n          {{? it.orgHierarchy.units[it.unitId].childIDs.length > 0}}\n            <div class="Caret">\n              <span class="before"></span>\n              <span class="after"></span>\n            </div>\n          {{?}}\n        </label>\n      </div>\n    </div>\n  </div>\n  <ul class="Children">\n    <div class="smallBarLoadingImage" style="display: none"></div>\n  </ul>\n</li>\n'},782:function(e,t){e.exports='<div class="MobileUnits">\n    <li>\n        <div class="smallBarLoadingImage"></div>\n    </li>\n</div>'},783:function(e,t,i){var n,s;n=[i(784),i(785),i(786),i(0),i(5),i(2),i(289)],void 0!==(s=function(e,t,i,n,s,r,a){"use strict";return n.Class.declare({$name:"TreeSelectSearchHTML",treeSelect:null,searchLimit:20,searchField:null,initialize:function(e){this.treeSelect=e,this.searchField=r.get(e.runtime,"OrgHierarchySearchField"),r.get(this.treeSelect,"OrgHierarchy")||(this.treeSelect.OrgHierarchy={id:this.treeSelect.runtime.OrgHierarchyId,units:{}})},render:function(){return s.template(e)({SearchPlaceholder:this.treeSelect.getMessageFromTemplate("SearchPlaceholder")})},setupSearch:function(){var e=s.template(t),i=e({ID:this.treeSelect.runtime.ID}),n=this.treeSelect._page.getActivePage();n.append(i),a.widget("custom.treeSelectSearch",a.ui.autocomplete,{_create:function(){this._super(),this.liveRegion.remove(),this.liveRegion=a("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(n),this.widget().menu("option","items","> :not(.header-menu-item)")},_renderItem:function(e,t){return a("<li>",{"aria-label":t.label}).append(t.customLabel).appendTo(e)}}),this.searchMenu=this.treeSelect._$el.find(".HierarchySearch"),this.searchMenu.treeSelectSearch({classes:{"ui-autocomplete":"AutoCompleteMenu"},delay:500,source:this._sendSearch.$bind(this),select:this._selectMenuUnit.$bind(this),appendTo:n.find(".AutoCompleteMenu"),focus:function(e){e.preventDefault()}.$bind(this)})},_positionAutoCompleteMenu:function(){var e=this.searchMenu.offset(),t=e.top+this.searchMenu.outerHeight();a(this.searchMenu.treeSelectSearch("instance").menu.activeMenu.context).css({top:t,left:e.left})},_sendSearch:function(e,t){this.treeSelect._page.adapter.searchOrgHierarchy(this.treeSelect.runtime.baseURL||this.treeSelect.runtime.BaseServiceURL,this.treeSelect.runtime.BrandId,this.treeSelect.runtime.OrgHierarchyId,e.term,this.searchField).then(function(i){this._positionAutoCompleteMenu();var n=i.length,s=this._prepareResults(i,e.term);t(s),this._renderHeaderMenuItem(n)}.$bind(this))},_renderHeaderMenuItem:function(e){var t=this.treeSelect.getMessageFromTemplate("ShowingResults",[e]);e>this.searchLimit&&(t=this.treeSelect.getMessageFromTemplate("ShowingFirstResults",[this.searchLimit]));var n=s.template(i),r=n({headerMessage:t});a(this.searchMenu.treeSelectSearch("instance").menu.activeMenu.context).prepend(r)},_prepareResults:function(e,t){return e.sort(function(e,t){return e.Name.localeCompare(t.Name)}),e.length==this.searchLimit+1&&e.pop(),r.map(e,function(e){this.searchField&&e[this.searchField]&&(e.Name=e.Name+" ("+e[this.searchField]+")");var i=e.Name.toLowerCase().indexOf(t.toLowerCase()),n=e.Name;if(-1!==i){n=e.Name.slice(0,i)+"<b>"+e.Name.slice(i,i+t.length)+"</b>"+e.Name.slice(i+t.length,e.Name.length)}return{label:e.Name,value:e.UnitID,customLabel:n}}.$bind(this))},_selectMenuUnit:function(e,t){this.treeSelect.getPage().blockNavigation("TreeSelect");var i=t.item.value;this.treeSelect.renderSelectedText(t.item.label),this.treeSelect.setResponseForSearch(i).then(function(){this.treeSelect.getPage().unblockNavigation("TreeSelect")}.$bind(this)),e.preventDefault()}})}.apply(t,n))&&(e.exports=s)},784:function(e,t){e.exports='<input type="text" id="HierarchySearchTest" class="HierarchySearch" placeholder="{{=it.SearchPlaceholder}}" >'},785:function(e,t){e.exports='<div id="{{= it.ID }}MenuContainer" class="MenuContainer TreeSelect">\n    <div class="AutoCompleteMenu"></div>\n</div>'},786:function(e,t){e.exports='<li class="header-menu-item">\n  <span >\n    {{= it.headerMessage}}\n  </span>\n</li>\n\n\n'},787:function(e,t){e.exports='<div class="QuestionText BorderColor">{{=Q.runtime.QuestionText}}</div>\n<div class="QuestionBody OrgHierarchy">\n  <div class="OHOuter v2">\n  </div>\n  <div class="SelctedTextContainer"></div>\n</div>'}});